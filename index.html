<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Luca Lietha ‚Äî Engineering Portfolio</title>
  <meta name="description" content="Robotics, ML, and control projects by Luca Lietha. Focus on medical and environmental robotics." />
  <meta property="og:title" content="Luca Lietha ‚Äî Engineering Portfolio" />
  <meta property="og:description" content="Selected projects in robotics, ML, and control." />
  <meta name="theme-color" content="#0ea5e9" />
  <style>
    :root{
      --bg: #0b0c10;         /* base (dark) */
      --bg-soft:#111318;     /* softer panels */
      --text:#e5e7eb;        /* foreground */
      --muted:#9aa3af;       /* secondary */
      --card:#0f1218;        /* cards */
      --accent:#38bdf8;      /* cyan */
      --accent-2:#7dd3fc;    /* cyan light */
      --ring: rgba(56,189,248,.55);
      --shadow: 0 10px 30px rgba(0,0,0,.28);
      --radius: 18px;
      --maxw: 1100px;
    }
    /* Light theme variables (toggle-controlled, default dark) */
    [data-theme="light"]{
      --bg:#f8fafc; --bg-soft:#ffffff; --text:#0f172a; --muted:#475569; --card:#ffffff; --shadow:0 8px 22px rgba(2,6,23,.08); --ring: rgba(14,165,233,.35);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:radial-gradient(1200px 600px at 20% -10%, rgba(56,189,248,.12), transparent 60%), radial-gradient(800px 500px at 100% 0%, rgba(186,230,253,.08), transparent 55%), var(--bg);
      color:var(--text);
      font: 16px/1.55 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
    }
    /* Make project pages perfectly flat (no subtle bands) */
    body.flat{ background: var(--bg) !important; }

    a{color:inherit; text-decoration:none}
    .wrap{max-width:var(--maxw); margin:0 auto; padding: 28px 20px 60px}
    header{position:sticky; top:0; backdrop-filter: blur(10px); background: color-mix(in oklab, var(--bg-soft) 80%, transparent); border-bottom:1px solid color-mix(in oklab, var(--text) 18%, transparent); z-index:10}
    header .wrap{display:flex; align-items:center; gap:14px; padding-top:14px; padding-bottom:14px}
    .brand{display:flex; align-items:center; gap:12px; font-weight:700; letter-spacing:.2px}
    .logo{width:36px; height:36px; border-radius:50%; display:grid; place-items:center; background:linear-gradient(135deg, var(--accent), var(--accent-2)); color:#003244; font-weight:800; box-shadow: var(--shadow)}
    nav{margin-left:auto; display:flex; gap:16px; align-items:center}
    nav a{padding:8px 12px; border-radius:10px; color:var(--muted)}
    nav a:hover{background: color-mix(in oklab, var(--accent) 22%, transparent); color: var(--text)}

    .hero{display:grid; grid-template-columns: 1fr; gap:22px; align-items:center; margin: 28px 0 10px}
    .hero h1{font-size: clamp(28px, 4vw, 44px); line-height:1.1; margin:0 0 10px}
    .hero p{color:var(--muted); margin:0}
    .cta{margin-top:16px; display:flex; gap:10px}
    .btn{background:linear-gradient(180deg, var(--accent), color-mix(in oklab, var(--accent) 90%, #000 10%)); border:none; color:#00202e; font-weight:700; padding:10px 14px; border-radius:12px; box-shadow: var(--shadow); cursor:pointer}
    .btn.secondary{background:transparent; color:var(--text); border:1px solid color-mix(in oklab, var(--text) 25%, transparent)}

    .theme-toggle{background:transparent; border:1px solid color-mix(in oklab, var(--text) 25%, transparent); padding:6px 10px; border-radius:10px; color:var(--muted); cursor:pointer}
    .theme-toggle:hover{background: color-mix(in oklab, var(--accent) 22%, transparent); color: var(--text)}

    .grid{display:grid; grid-template-columns: repeat(12, 1fr); gap: 18px; margin-top: 28px}
    .card{grid-column: span 4; background:var(--card); border:1px solid color-mix(in oklab, var(--text) 12%, transparent); border-radius: var(--radius); overflow: clip; box-shadow: var(--shadow); transition: transform .12s ease, box-shadow .12s ease, border-color .12s}
    .card:hover{transform: translateY(-3px); box-shadow: 0 16px 36px rgba(0,0,0,.22); border-color: color-mix(in oklab, var(--accent) 35%, transparent)}
    .cover{aspect-ratio: 16/10; width:100%; object-fit:cover; display:block}
    .card .content{padding:14px}
    .title{font-weight:700; margin: 4px 0}
    .summary{color:var(--muted); font-size:14px}
    .tags{display:flex; gap:6px; flex-wrap:wrap; margin-top:10px}
    .tag{font-size:12px; color: var(--muted); background: color-mix(in oklab, var(--accent) 12%, transparent); border:1px solid color-mix(in oklab, var(--text) 16%, transparent); padding:4px 8px; border-radius:999px}

    .detail{max-width: 900px; margin: 28px auto 0}
    .back{display:inline-flex; align-items:center; gap:8px; color:var(--muted); border:1px solid color-mix(in oklab, var(--text) 16%, transparent); padding:8px 10px; border-radius:12px}
    .back:hover{color:var(--text); border-color: color-mix(in oklab, var(--accent) 35%, transparent)}
    .detail h1{margin:18px 0 8px}
    .meta{color:var(--muted)}
    .body p{margin: 14px 0}

    .media-grid{display:grid; grid-template-columns: repeat(12, 1fr); gap:14px; margin: 18px 0}
    .media-grid img, .media-grid video, .media-grid iframe{width:100%; border-radius:14px; border:1px solid color-mix(in oklab, var(--text) 14%, transparent)}
    .media-grid .wide{grid-column: span 12}
    .media-grid .half{grid-column: span 6}
    .media-grid .third{grid-column: span 4}
    .media-grid .quarter{grid-column: span 3}
    .media-grid figure{margin:0}
    .media-grid figcaption{font-size:13px;color:var(--muted);margin-top:6px}
    .yt iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:0}

    footer{margin-top:46px; padding-top:20px; border-top:1px dashed color-mix(in oklab, var(--text) 16%, transparent); color:var(--muted); text-align:center}

    @media (max-width: 980px){
      .hero{grid-template-columns: 1fr; gap: 10px}
      .grid .card{grid-column: span 6}
      .media-grid .half{grid-column: span 12}
    }
    @media (max-width: 640px){
      .grid .card{grid-column: span 12}
    }
    .hidden{display:none}
    .sr{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0}
      /* Avatar + compact sections + YouTube placeholders */
    .avatar{width:36px;height:36px;border-radius:50%;object-fit:cover;box-shadow:var(--shadow);border:1px solid color-mix(in oklab, var(--text) 18%, transparent); display:none;}
    .detail details{border:1px solid color-mix(in oklab, var(--text) 16%, transparent); background:transparent; padding:12px 14px; border-radius:14px; margin:12px 0}
    .detail details[open]{box-shadow: var(--shadow)}
    .yt{position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:14px;border:1px solid color-mix(in oklab, var(--text) 14%, transparent);background-position:center;background-size:cover;cursor:pointer}
    .yt::after{content:'\25B6'; position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); font-size:42px; line-height:1; width:68px; height:68px; border-radius:50%; display:grid; place-items:center; background:rgba(0,0,0,.55); color:white}
    .yt.playing::after{display:none}
      /* Scenario comparison (CSS-only tabs) */
    .scenario-viewer{margin-top:12px}
    .scenario-viewer .tabs{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0 12px}
    .scenario-viewer .tabs input{display:none}
    .scenario-viewer .tabs label{padding:6px 10px;border:1px solid color-mix(in oklab, var(--text) 18%, transparent);border-radius:10px;color:var(--muted);cursor:pointer}
    .scenario-viewer .tabs input:checked + label{background: color-mix(in oklab, var(--accent) 18%, transparent);color: var(--text);border-color: color-mix(in oklab, var(--accent) 45%, transparent)}
    .scenario-viewer .panels .panel{display:none}
    /* Show the selected scenario's panel */
    #cc-s1:checked ~ .panels [data-for="cc-s1"],
    #cc-s2:checked ~ .panels [data-for="cc-s2"],
    #cc-s3:checked ~ .panels [data-for="cc-s3"],
    #cc-s4:checked ~ .panels [data-for="cc-s4"]{display:block}

    /* Under construction notice */
    .notice{display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:12px; border:1px dashed color-mix(in oklab, var(--accent) 45%, transparent); background: color-mix(in oklab, var(--accent) 12%, transparent); margin: 8px 0 12px;}
    .notice .emoji{font-size:18px;}
    .muted-list{color:var(--muted); margin:8px 0 0 20px}

    /* Focus styles for accessibility */
    a:focus-visible, button:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    /* Zoomable media & lightbox */
    .zoomable{cursor: zoom-in;}
    .lightbox{position:fixed; inset:0; display:none; align-items:center; justify-content:center; padding:20px; background:rgba(0,0,0,.78); z-index:9999}
    .lightbox.open{display:flex}
    .lightbox__inner{max-width:95vw; max-height:92vh; display:flex; align-items:center; justify-content:center}
    .lightbox__img{max-width:95vw; max-height:92vh; border-radius:14px; box-shadow: var(--shadow); background: var(--bg-soft)}
    .lightbox__close{position:absolute; top:14px; right:14px; background:rgba(0,0,0,.45); color:white; border:1px solid rgba(255,255,255,.3); font-size:22px; border-radius:10px; padding:6px 10px; cursor:pointer}
    .no-scroll{overflow:hidden}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <a class="brand" href="#/">
        <img class="avatar" id="avatar" src="assetsforportfolio/CMOM_profile_picture.png" alt="Profile picture">
        <span>Engineering Portfolio</span>
      </a>
      <nav>
        <a href="#/">Projects</a>
        <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme" title="Toggle theme" aria-pressed="true">‚òÄ</button>
      </nav>
    </div>
  </header>

  <main class="wrap" id="app" aria-live="polite"></main>

  <!-- Lightbox modal (click images to open) -->
  <div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-hidden="true">
    <button class="lightbox__close" id="lightboxClose" aria-label="Close">‚úï</button>
    <div class="lightbox__inner">
      <img id="lightboxImg" class="lightbox__img" alt="Expanded media" />
    </div>
  </div>

  <footer>
    <div class="wrap">¬© <span id="year"></span> <span id="owner">Luca Lietha</span>. Built with a single HTML file. Hosted on GitHub Pages.</div>
  </footer>

  <script>
    // ---------------------
    // 1) PROJECT DATA
    // ---------------------
    const projects = [
      {
        slug: 'bachelor-thesis',
        title: 'Bachelor Thesis: Model Predictive Contouring Control with Uncertainty Estimation using Deep Evidential Koopman Operators',
        cover: 'assetsforportfolio/Bachelor Thesis Project Picture.png',
        summary: 'Extended Deep Evidential Koopman Operators with MPCC for uncertainty-aware path tracking in autonomous robots.',
        date: '',
        tags: ['Thesis','Research','Control','Robotics','Optimization','Uncertainty'],
        bodyHtml: `          <p>In my bachelor thesis, I extended the <em>Deep Evidential Koopman Operator</em> framework to enable uncertainty-aware path tracking for autonomous robots. Specifically, I:</p>
          <ul>
            <li>Integrated Model Predictive Contouring Control (MPCC) into the existing Koopman control framework to allow robots to follow a reference path while avoiding regions of high <em>epistemic uncertainty</em>.</li>
            <li>Developed a path generation module for static global trajectories compatible with the contouring control formulation.</li>
            <li>Implemented and tested the system in simulation, demonstrating its ability to accurately follow paths, handle position constraints, and deviate safely from paths in areas with high uncertainty.</li>
          </ul>
          <p>This work combines control theory, uncertainty quantification, and optimization to improve the safety and reliability of learning‚Äëbased robotic controllers.</p>
          <div class="cta">
            <a class="btn" href="assetsforportfolio/Luca_Lietha___Bachelor_Thesis.pdf" download target="_blank" rel="noopener">Download Thesis (PDF)</a>
          </div>
        `,
        images: [],
        videos: []
      },
      {
        slug: 'computational-models-of-motion',
        title: 'Computational Models of Motion ‚Äî Course Project',
        cover: 'assetsforportfolio/Computational Models of Motion Project Picture.png',
        summary: 'Kinematics ‚Üí trajectory optimization ‚Üí deep RL imitation; three compact subprojects with demos.',
        date: '',
        tags: ['Course Project','Robotics','Motion','RL','Optimization'],
        bodyHtml: `
          <p>This course introduces the mathematical foundations and computational tools for generating motion for digital humans, virtual creatures, and robots. It blends applied mathematics, control theory, and machine learning, and is illustrated through locomotion controllers, trajectory optimization, and deep‚ÄëRL‚Äëbased motion synthesis.</p>

          <p><strong>Topics covered:</strong> kinematic modeling; unconstrained/constrained optimization and inverse kinematics; sensitivity analysis; trajectory optimization; feedback control and locomotion; foundations of deep reinforcement learning; learning methods for motion synthesis; invited lecture.</p>

          <h3>Subprojects</h3>

          <details class="cardlike"><summary><strong>1) Kinematic walking controller</strong></summary>
            <ul>
              <li>Implemented foot forward kinematics and both finite‚Äëdifference and analytic Jacobians.</li>
              <li>Built a Gauss‚ÄìNewton IK solver (FD Jacobian for grading) and a base trajectory planner via velocity integration.</li>
              <li>Added uneven‚Äëterrain support (height‚Äëmap y‚Äëoffsets) and defined a hexapod foot‚Äëcontact (gait) timeline.</li>
              <li>Validated in quadruped/hexapod simulation and deployed on SpiderPi hexapod hardware.</li>
            </ul>
            <div class="media-grid">
              <figure class="third"><div class="yt" data-yt="https://youtu.be/uCh3qL2x7Hs"></div><figcaption>Kinematic walking controller for a quadruped robot</figcaption></figure>
              <figure class="third"><div class="yt" data-yt="https://youtu.be/M8dzODGkXxI"></div><figcaption>Kinematic walking controller for a hexapod robot</figcaption></figure>
              <figure class="third"><div class="yt" data-yt="https://youtube.com/shorts/ZUIcOtcyFh8?feature=share"></div><figcaption>Hexapod controller on hardware</figcaption></figure>
            </div>
          </details>

          <details class="cardlike"><summary><strong>2) Trajectory optimization for quadruped robots</strong></summary>
            <ul>
              <li>Built a multiple‚Äëshooting trajectory optimizer in <em>CasADi</em> using a single rigid‚Äëbody model; ran experiments at 50&nbsp;Hz.</li>
              <li>Implemented objectives to track kinematic references with smoothness/continuity costs.</li>
              <li>Added constraints: system dynamics; initial state; ground contact (no penetration), zero swing forces, no foot‚Äëskating; friction pyramid.</li>
              <li>Generated missing foot paths for partial references; enforced shoulder‚Äëplane constraint.</li>
              <li>Extended to jumps/bounds/backflips with feasibility fixes (leg‚Äëlength, keyframes).</li>
              <li>Playback + control in MuJoCo with PD + feedforward torques from Jacobian transpose.</li>
            </ul>
            <div class="media-grid">
              <figure class="half"><div class="yt" data-yt="https://youtu.be/tKlLVA-S8p4"></div><figcaption>Playback of optimized trajectories in MuJoCo</figcaption></figure>
              <figure class="half"><div class="yt" data-yt="https://youtu.be/3H1YKNTbXBA"></div><figcaption>Tracking optimized trajectories with FF + PID</figcaption></figure>
            </div>
          </details>

          <details class="cardlike"><summary><strong>3) Deep RL for humanoid motion imitation</strong></summary>
            <ul>
              <li>Trained a simulated humanoid in Isaac Gym with PPO to imitate walking and a cartwheel.</li>
              <li>Designed rewards (pose, orientation, velocities, end‚Äëeffectors, smoothness) and a phase variable.</li>
              <li>Used Reference State Initialization (RSI) and quaternion orientation to avoid gimbal lock.</li>
              <li>Logged runs to Weights &amp; Biases; tuned until stable imitation; exported videos/plots.</li>
            </ul>
            <div class="media-grid">
              <figure class="half"><div class="yt" data-yt="https://youtu.be/oZsgSzABSHc"></div><figcaption>Walking motion</figcaption></figure>
              <figure class="half"><div class="yt" data-yt="https://youtu.be/w-ADT8fwUsE"></div><figcaption>Cartwheel motion</figcaption></figure>
            </div>
          </details>
        `,
        images: [],
        videos: []
      },
      {
        slug: 'planning-and-decision-making',
        title: 'Planning & Decision Making for Autonomous Robots ‚Äî Course Project',
        cover: 'assetsforportfolio/Planning and Decision Making Project Picture.png',
        summary: 'Six subparts: Graph search, Dynamic programming, Dubins path, Collision checking, Spaceship, Highway driving.',
        date: '',
        tags: ['Course Project','Planning','Decision-Making','Graph Search','A*','UCS','Dynamic Programming'],
        bodyHtml: `
    <p>Algorithms and decision-making pipelines for navigation and control. Below are compact subparts focusing on what I built and evaluated.</p>

    <h3>Subparts</h3>

    <details class="cardlike"><summary><strong>1) Graph Search (BFS/DFS/IDDFS + UCS/A*)</strong></summary>
      <ul>
        <li>Implemented classic search (BFS, DFS, Iterative Deepening) and shortest-path search (UCS, A*).</li>
        <li>Deterministic neighbor handling: sort new neighbors, avoid duplicates; return <em>Path</em> and <em>OpenedNodes</em>.</li>
        <li>A*: admissible time lower bound = great-circle distance / max speed.</li>
      </ul>
    </details>

    <details class="cardlike"><summary><strong>2) Dynamic Programming (Value / Policy Iteration)</strong></summary>
      <ul>
        <li>Grid MDP with stochastic motion, wormholes, breakdown/abandon, and time/fuel costs.</li>
        <li>Implemented value iteration and policy iteration; outputs optimal value map and policy.</li>
      </ul>
    </details>

    <details class="cardlike"><summary><strong>3) Dubins Path</strong></summary>
      <ul>
        <li>Generated curvature-bounded (Dubins) paths for a car-like robot under minimum turn radius.</li>
        <li>Integrated into local planning to compare path families (RSR/RSL/LSR/LSL/‚Ä¶); picked shortest feasible.</li>
      </ul>
    </details>

    <details class="cardlike"><summary><strong>4) Collision Checking</strong></summary>
      <ul>
        <li>Built SAT-based polygon/circle checks, plus occupancy-grid and R-tree variants for speed.</li>
        <li>Also implemented robot-frame checks and safety-certificate acceleration.</li>
        <li>Used to prune invalid states/edges in planners.</li>
      </ul>
    </details>

    <details class="cardlike"><summary><strong>5) Spaceship</strong></summary>
      <ul>
        <li>Implemented a sequential convexification (SCvx) stack with zero/first-order holds for linearization.</li>
        <li>Constraints: thrust/angle/rate limits, arrival pose/vel, time budget, obstacle avoidance, mass/fuel.</li>
        <li>Evaluated planner in three different scenarios.</li>
      </ul>
      <div class="media-grid">
        <figure class="third">
          <div class="yt" data-yt="https://youtube.com/shorts/DGAiyCBHpvc?feature=share"></div>
          <figcaption>Scenario 1 ‚Äî Docking through planets</figcaption>
        </figure>
        <figure class="third">
          <div class="yt" data-yt="https://youtube.com/shorts/BQusGgvJpu?feature=share"></div>
          <figcaption>Scenario 2 ‚Äî Static goal with moving satellites</figcaption>
        </figure>
        <figure class="third">
          <div class="yt" data-yt="https://youtube.com/shorts/aVQ-uDb_ZPU?feature=share"></div>
          <figcaption>Scenario 3 ‚Äî Docking with moving satellites</figcaption>
        </figure>
      </div>
    </details>

    <details class="cardlike"><summary><strong>6) Highway Driving</strong></summary>
      <p>Built a lane‚Äëchange planning & control stack for an autonomous car in mixed traffic with unknown human policies (CommonRoad lanelets, kinematic bicycle, closed‚Äëloop simulator).</p>
      <ul>
        <li>Hierarchical planner: behavior (keep/prepare/perform lane change) + local trajectory scoring optimizing TTC risk, lane‚Äëchange time, comfort, and rule compliance.</li>
        <li>360¬∞ LiDAR‚Äëstyle observations with occlusions; constant‚Äëvelocity prediction with safety margins.</li>
        <li>Constraint handling & continuous collision checks against lane geometry and moving vehicles.</li>
        <li>Split planning/control rates (plan slower, control 10‚ÄØHz) with kinematic‚Äëbicycle tracking.</li>
        <li>Benchmarked on basic, dense, and near‚Äëexit‚Äëmerge scenarios vs KPIs (collision/success, TTC, time, comfort, computation).</li>
      </ul>
      <div class="media-grid">
        <div class="third"><div class="yt" data-yt="https://youtube.com/shorts/gGNUKM6nwdQ?feature=share"></div></div>
        <div class="third"><div class="yt" data-yt="https://youtube.com/shorts/8ByrrcIDmcI?feature=share"></div></div>
        <div class="third"><div class="yt" data-yt="https://youtube.com/shorts/fwiVEdY9obw?feature=share"></div></div>
      </div>
    </details>
  `,
  images: [],
  videos: []
},

      {
        slug: 'mobile-health-activity-monitoring',
        title: 'Mobile Health & Activity Monitoring ‚Äî Course Project',
        cover: 'assetsforportfolio/Mobile Health Project Picture.png',
        summary: 'Wearable‚Äësensor pipeline for activity recognition and health metrics.',
        date: '',
        tags: ['Course Project','mHealth','Wearables','ML'],
        bodyHtml: `<aside class="notice"><span class="emoji" aria-hidden="true">üöß</span> Under construction.</aside>`,
        images: [],
        videos: []
      },
      {
        slug: 'introduction-to-mechatronics',
        title: 'Introduction to Robotics and Mechatronics ‚Äî Course Project',
        cover: 'assetsforportfolio/Introduction to Robotics Projec Picture.png',
        summary: 'Ball‚Äëon‚Äëplate: modeling, control & software on provided hardware.',
        date: '',
        tags: ['Course Project','Mechatronics','Embedded','Robotics'],
        bodyHtml: `
          <p><em>Ball‚Äëon‚Äëplate robot (hardware provided; my focus: modeling, control, and software)</em></p>
          <ul>
            <li><strong>Sensing &amp; bring‚Äëup:</strong> ESP32 control stack; Pixy2 camera over SPI; pixel‚Üíworld calibration for accurate position estimates.</li>
            <li><strong>Kinematics:</strong> Derived 3‚ÄëRRS plate inverse kinematics mapping desired plate tilt ‚Üí servo commands.</li>
            <li><strong>Modeling:</strong> Formulated ball‚Äëon‚Äëplate dynamics and linearized about zero tilt for controller design.</li>
            <li><strong>Control:</strong> Discrete PID with anti‚Äëwindup, rate limiting, and saturation handling; setpoint/trajectory generator (steps, circles).</li>
            <li><strong>Latency &amp; filtering:</strong> Compensated ~20‚ÄØms sensing delay; ‚âà60‚ÄØHz measurement loop; low‚Äëpass and derivative filtering for noise/latency.</li>
            <li><strong>Robustness &amp; safety:</strong> Disturbance rejection (taps), watchdogs, soft bounds, and a failsafe flat‚Äëplate mode.</li>
            <li><strong>Outcome:</strong> Stable closed‚Äëloop tracking of setpoints and circular trajectories; smooth recovery from perturbations (see videos below).</li>
            <li><strong>Tech stack:</strong> C++/Arduino (ESP32), Python for calibration/logging, plotting‚Äëdriven tuning workflow.</li>
          </ul>
          <div class="media-grid">
            <div class="third"><div class="yt" data-yt="https://youtube.com/shorts/Yji1pZ6IBtU?feature=share"></div></div>
            <div class="third"><div class="yt" data-yt="https://youtube.com/shorts/nKngOLTO-3A?feature=share"></div></div>
            <div class="third"><div class="yt" data-yt="https://youtube.com/shorts/vU4YdiH_4Po?feature=share"></div></div>
          </div>
        `,
        images: [],
        videos: []
      },
      {
        slug: 'computational-control',
        title: 'Computational Control ‚Äî Course Project',
        cover: 'assetsforportfolio/COCO Project Picture.png',
        summary: 'MPC vs. DeePC for dynamic speed limits on a 5‚Äëregion city; SUMO evaluation; measurable gains over baseline P.',
        date: '',
        tags: ['Course Project','Control','Optimization','MPC','DeePC','Traffic','SUMO'],
        bodyHtml: `
          <p><em>COCO City dynamic speed‚Äëlimit control.</em> I designed, implemented, and compared a model‚Äëbased MPC and a data‚Äëdriven DeePC controller for a five‚Äëregion macroscopic traffic network, evaluated in a SUMO closed‚Äëloop simulator.</p>
          <ul>
            <li><strong>Problem:</strong> Morning inbound congestion; the baseline P controller can destabilize queues under demand surges.</li>
            <li><strong>Model‚Äëbased (MPC):</strong> Linear network model ‚Üí QP‚Äëbased MPC with horizon <em>N</em>, bounds on densities/speeds, soft constraints; objective trades off target densities and control effort. Tuned (<em>Q, R, N</em>) with warm starts.</li>
            <li><strong>Data‚Äëdriven (DeePC):</strong> Past/future Hankel matrices from provided data; Tikhonov and projection regularizers; hyper‚Äëparameters (Œª<sub>y</sub>, Œª<sub>g</sub>) via grid search. Robust to model mismatch.</li>
            <li><strong>Evaluation:</strong> Scenarios <em>no control</em> vs <em>P</em> vs <em>MPC</em> vs <em>DeePC</em>. KPIs: mean travel time, total delay/stopped time, queue lengths, successful trips. Plots and GIF heatmaps summarize behavior.</li>
            <li><strong>Outcome:</strong> Both MPC and DeePC outperformed no‚Äëcontrol and the P baseline; DeePC handled demand shifts best, MPC provided transparent constraint handling for deployment.</li>
            <li><strong>Deliverables:</strong> Self‚Äëcontained Jupyter notebook (reproducible figures/tables) and a concise 5‚Äëslide brief for non‚Äëtechnical stakeholders.</li>
          </ul>

          <details class="cardlike"><summary><strong>Results ‚Äî key outcomes & visuals</strong></summary>
            <div class="media-grid">
              <figure class="wide">
                <img class="zoomable" data-zoomable src="assetsforportfolio/COCO/metric(3).png" alt="KPIs across scenarios: No Controller, P, MPC, DeePC" loading="lazy"/>
                <figcaption>Overall KPIs across all four scenarios (CO‚ÇÇ, travel time, waiting time, #vehicles).</figcaption>
              </figure>

              <figure class="half">
                <img class="zoomable" data-zoomable src="assetsforportfolio/COCO/plot(1).png" alt="Flow/ density comparison: P vs No Controller" loading="lazy"/>
                <figcaption>Dynamics: <strong>P vs No Controller</strong> ‚Äî effect of simple feedback vs no control.</figcaption>
              </figure>
              <figure class="half">
                <img class="zoomable" data-zoomable src="assetsforportfolio/COCO/plot(4).png" alt="Flow/ density comparison: P vs MPC vs DeePC" loading="lazy"/>
                <figcaption>Dynamics: <strong>P vs MPC vs DeePC</strong> ‚Äî model‚Äëbased vs data‚Äëdriven controllers.</figcaption>
              </figure>

              <figure class="quarter">
                <img class="zoomable" data-zoomable data-gif-loop data-gif-duration="7000" src="assetsforportfolio/COCO/no_control_demo_heatmap.gif" alt="No Controller ‚Äî network evolution heatmap (GIF)"/>
                <figcaption>No Controller ‚Äî evolution</figcaption>
              </figure>
              <figure class="quarter">
                <img class="zoomable" data-zoomable data-gif-loop data-gif-duration="7000" src="assetsforportfolio/COCO/P_control_demo_heatmap.gif" alt="P Controller ‚Äî network evolution (GIF)"/>
                <figcaption>P ‚Äî evolution</figcaption>
              </figure>
              <figure class="quarter">
                <img class="zoomable" data-zoomable data-gif-loop data-gif-duration="7000" src="assetsforportfolio/COCO/MPC_control_demo_heatmap.gif" alt="MPC ‚Äî network evolution (GIF)"/>
                <figcaption>MPC ‚Äî evolution</figcaption>
              </figure>
              <figure class="quarter">
                <img class="zoomable" data-zoomable data-gif-loop data-gif-duration="7000" src="assetsforportfolio/COCO/DeePC_control_demo_heatmap.gif" alt="DeePC ‚Äî network evolution (GIF)"/>
                <figcaption>DeePC ‚Äî evolution</figcaption>
              </figure>
            </div>
           
          </details>
        `,
        images: [],
        videos: []
      },
      {
        slug: 'introduction-to-machine-learning',
        title: 'Introduction to Machine Learning ‚Äî Course Project',
        cover: 'assetsforportfolio/IML_Project_Picture_smaller.png',
        summary: 'Built ML models for classification/regression with proper validation.',
        date: '',
        tags: ['Course Project','Machine Learning'],
        bodyHtml: `<aside class="notice"><span class="emoji" aria-hidden="true">üöß</span> Under construction.</aside>`,
        images: [],
        videos: []
      }
    ];

    // ---------------------
    // 2) TINY ROUTER
    // ---------------------
    const app = document.getElementById('app');
    let _gifTimers = [];

    function clearGifLoops(){ _gifTimers.forEach(id=>clearInterval(id)); _gifTimers = []; }

    function route(){
      const hash = location.hash || '#/'
      // Stop any GIF-loop timers when navigating
      clearGifLoops();
      // Flatten background on detail pages to remove gradient bands
      document.body.classList.toggle('flat', hash.startsWith('#/project/'));
      if(hash.startsWith('#/project/')){
        const slug = decodeURIComponent(hash.replace('#/project/',''));
        renderProject(slug);
      } else {
        renderHome();
      }
      initYouTubePlaceholders(document);
      scrollTo({top:0, behavior:'instant'});
    }

    window.addEventListener('hashchange', route);
    window.addEventListener('DOMContentLoaded', ()=>{
      document.getElementById('year').textContent = new Date().getFullYear();
      route();
      validateProjects();
    });

    window.addEventListener('DOMContentLoaded', ()=>{
      document.querySelectorAll('.yt').forEach(el=>{
        const val = el.getAttribute('data-yt') || el.getAttribute('data-ytid');
        const id = extractYouTubeId(val);
        if(id){
          el.style.backgroundImage = `url('https://img.youtube.com/vi/${id}/hqdefault.jpg')`;
          el.dataset.ytid = id;
        }
      });
    });

    // ---------------------
    // 3) VIEWS
    // ---------------------
    function renderHome(){
      app.innerHTML = `
        <section class="hero">
          <div>
            <h1>I‚Äôm <span id="owner-inline">Luca</span>. I try to combine my interests in robotics, machine learning, and control with applications that benefit people and society. I‚Äôm specifically interested in medical and environmental robotics.</h1>
            <p>Below is a selection of recent projects. Click any card to see videos, images, and write‚Äëups.</p>
          </div>
        </section>
        <section>
          <div class="grid" id="cards"></div>
        </section>
      `;

      const grid = document.getElementById('cards');
      projects.forEach(p=>{
        const card = document.createElement('a');
        card.className = 'card';
        card.href = `#/project/${encodeURIComponent(p.slug)}`;
        card.innerHTML = `
          <img class="cover" src="${p.cover}" alt="${escapeHtml(p.title)} cover" loading="lazy"/>
          <div class="content">
            <div class="title">${escapeHtml(p.title)}</div>
            <div class="summary">${escapeHtml(p.summary)}</div>
            <div class="tags">${(p.tags||[]).map(t=>'<span class="tag">'+escapeHtml(t)+'</span>').join('')}</div>
          </div>`;
        grid.appendChild(card);
      });
    }

    function renderAbout(){
      app.innerHTML = `
        <a class="back" href="#/"><span aria-hidden>‚Üê</span> Back to Projects</a>
        <section class="detail">
          <h1>About</h1>
          <p class="meta">Short bio and CV highlights.</p>
          <div class="body">
            <p>Replace this with a few lines about your background, interests, and what you‚Äôre looking for. You can also link your <a href="your-cv.pdf" target="_blank" rel="noopener">CV</a> and GitHub/LinkedIn.</p>
          </div>
        </section>
      `;
    }

    function renderProject(slug){
      const p = projects.find(x=>x.slug===slug);
      if(!p){
        app.innerHTML = `
          <a class="back" href="#/"><span aria-hidden>‚Üê</span> Back to Projects</a>
          <section class="detail"><h1>Not found</h1><p>We couldn‚Äôt find that project. Try the list again.</p></section>`;
        return;
      }

      const metaBits = [];
      if (p.date) metaBits.push(new Date(p.date).toLocaleDateString());
      if (p.tags?.length) metaBits.push(p.tags.map(escapeHtml).join(' ¬∑ '));
      const metaHtml = metaBits.join(' ¬∑ ');

      app.innerHTML = `
        <a class="back" href="#/"><span aria-hidden>‚Üê</span> Back to Projects</a>
        <article class="detail">
          <img class="cover" src="${p.cover}" alt="${escapeHtml(p.title)} cover" style="border-radius: var(--radius); border:1px solid color-mix(in oklab, var(--text) 14%, transparent)"/>
          <h1>${escapeHtml(p.title)}</h1>
          <div class="meta">${metaHtml}</div>
          <div class="body">${p.bodyHtml || ''}</div>
          ${renderMedia(p)}
        </article>
      `;

      // After rendering, enable zoom + looping for the Computational Control section
      if (slug === 'computational-control'){
        const article = app.querySelector('article.detail');
        initZoomable(article);
        setupGifLooping(article);
      }
    }

    function renderMedia(p){
      const imgs = (p.images||[]).map(img=>{
        const span = img.span==='half' ? 'half' : 'wide';
        return `<div class="${span}"><img src="${img.src}" alt="${escapeHtml(img.alt||p.title)}" loading="lazy"></div>`
      });
      const vids = (p.videos||[]).map(v=>{
        if(v.type==='youtube' && v.id){
          return `<div class="wide"><div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:14px;border:1px solid color-mix(in oklab, var(--text) 14%, transparent)"><iframe src="https://www.youtube.com/embed/${v.id}" title="YouTube video" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen style="position:absolute;top:0;left:0;width:100%;height:100%"></iframe></div></div>`
        }
        if(v.type==='mp4' && v.src){
          return `<div class="wide"><video controls preload="metadata" src="${v.src}" style="max-height:70vh"></video></div>`
        }
        return '';
      });
      const all = [...imgs, ...vids].filter(Boolean);
      if(!all.length) return '';
      return `<div class="media-grid">${all.join('')}</div>`;
    }

    // ---------------------
    // 4) HELPERS & SELF-TESTS
    // ---------------------
    function escapeHtml(str){
      return String(str).replace(/[&<>"']/g, s=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[s]));
    }

    function validateProjects(){
      try{
        console.assert(Array.isArray(projects), 'projects should be an array');
        const seen = new Set();
        projects.forEach((p,i)=>{
          console.assert(p && typeof p==='object', `Project[${i}] should be object`);
          console.assert(p.slug, `Project[${i}] missing slug`);
          console.assert(!seen.has(p.slug), `Duplicate slug ${p.slug}`);
          seen.add(p.slug);
          console.assert(typeof p.title==='string', `Project[${i}] missing title`);
          console.assert(typeof p.bodyHtml==='string', `Project[${i}] missing bodyHtml`);
        });
        console.log('Project validation OK');
      }catch(e){
        console.error('Project validation failed', e);
      }
    }

    // YouTube lazy embeds (click to load)
    document.addEventListener('click', (e) => {
      const el = e.target.closest('.yt');
      if(!el) return;
      const id = el.dataset.ytid || extractYouTubeId(el.getAttribute('data-yt')||el.getAttribute('data-ytid'));
      if(!id) return;
      el.classList.add('playing');
      el.style.backgroundImage = 'none';
      el.innerHTML = `<iframe src="https://www.youtube.com/embed/${id}?autoplay=1&rel=0" title="YouTube video" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`;
    });

    // Theme toggle
    (function(){
      const STORAGE_KEY = 'theme';
      const metaTheme = document.querySelector('meta[name="theme-color"]');
      function setTheme(t){
        document.documentElement.dataset.theme = t;
        localStorage.setItem(STORAGE_KEY, t);
        if(metaTheme){ metaTheme.setAttribute('content', t==='light' ? '#f8fafc' : '#0b0c10'); }
        const btn = document.getElementById('themeToggle');
        if(btn){
          const isDark = t === 'dark';
          btn.textContent = t==='light' ? 'üåô' : '‚òÄ';
          btn.title = t==='light' ? 'Switch to dark' : 'Switch to light';
          btn.setAttribute('aria-pressed', String(isDark));
        }
      }
      const saved = localStorage.getItem(STORAGE_KEY);
      setTheme(saved || 'dark');
      document.addEventListener('click', (e)=>{
        const b = e.target.closest('#themeToggle');
        if(!b) return;
        const next = (document.documentElement.dataset.theme === 'light') ? 'dark' : 'light';
        setTheme(next);
      });
    })();

    function extractYouTubeId(s){
      if(!s) return '';
      try{
        const u = new URL(s, 'https://example.com');
        const host = (u.host||'').replace(/^www\./,'');
        if(host.includes('youtube.com')){
          if(u.pathname.startsWith('/watch')) return u.searchParams.get('v')||'';
          if(u.pathname.startsWith('/shorts/')) return u.pathname.split('/')[2]||'';
          if(u.pathname.startsWith('/embed/')) return u.pathname.split('/')[2]||'';
        }
        if(host==='youtu.be'){
          return u.pathname.slice(1).split('/')[0]||'';
        }
      }catch(e){
        return String(s);
      }
      return String(s);
    }

    function initYouTubePlaceholders(scope=document){
      scope.querySelectorAll('.yt').forEach(el=>{
        const val = el.getAttribute('data-yt') || el.getAttribute('data-ytid');
        const id = extractYouTubeId(val);
        if(id){
          el.style.backgroundImage = `url('https://img.youtube.com/vi/${id}/hqdefault.jpg')`;
          el.dataset.ytid = id;
        }
      });
    }

    // ---------------------
    // 5) LIGHTBOX + GIF LOOPING (Computational Control section)
    // ---------------------
    function initZoomable(scope=document){
      const lb = document.getElementById('lightbox');
      const lbImg = document.getElementById('lightboxImg');
      const lbClose = document.getElementById('lightboxClose');

      function open(src, alt=''){
        lbImg.src = src;
        lbImg.alt = alt || 'Expanded media';
        lb.classList.add('open');
        lb.setAttribute('aria-hidden','false');
        document.body.classList.add('no-scroll');
      }
      function close(){
        lb.classList.remove('open');
        lb.setAttribute('aria-hidden','true');
        document.body.classList.remove('no-scroll');
        lbImg.src = '';
        lbImg.alt = '';
      }

      // Click-to-open
      scope.querySelectorAll('img[data-zoomable]').forEach(img=>{
        img.classList.add('zoomable');
        img.addEventListener('click', ()=> open(img.src, img.alt));
        img.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); open(img.src, img.alt);} });
        img.setAttribute('tabindex','0');
        img.setAttribute('role','button');
        img.setAttribute('aria-label','Open full size');
      });

      // Close interactions
      lb.addEventListener('click', (e)=>{ if(e.target === lb) close(); });
      lbClose.addEventListener('click', close);
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && lb.classList.contains('open')) close(); });
    }

    function setupGifLooping(scope=document){
      const gifs = scope.querySelectorAll('img[data-gif-loop]');
      gifs.forEach(img=>{
        const ms = parseInt(img.getAttribute('data-gif-duration')||'7000', 10);
        // Periodically restart the GIF by cache-busting the src.
        // NOTE: True infinite looping depends on the GIF's internal loop setting.
        const restart = ()=>{
          const base = img.src.split('#')[0].split('?')[0];
          img.src = base + '?t=' + Date.now();
        };
        // Start a timer and keep reference so we can clear on navigation
        const id = setInterval(restart, ms);
        _gifTimers.push(id);
      });
    }

    document.getElementById('owner').textContent = 'Luca Lietha';
    const ownerInline = document.getElementById('owner-inline');
    if(ownerInline) ownerInline.textContent = 'Luca';
  </script>
</body>
</html>

